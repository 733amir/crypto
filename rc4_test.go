package crypto

import "testing"

func TestInit(t *testing.T) {
	inputKey := []byte{0, 1, 2, 3, 4, 5, 6, 7, 8}
	outputStream := []byte{
		7, 240, 32, 114, 221, 74, 193, 215, 205, 235, 170, 158, 196, 96, 116,
		248, 130, 51, 164, 79, 174, 189, 88, 171, 204, 7, 33, 217, 109, 176,
		178, 212, 149, 0, 231, 226, 182, 220, 68, 217, 110, 133, 117, 53, 149,
		202, 204, 123, 213, 60, 172, 96, 100, 56, 167, 232, 102, 28, 13, 88,
		110, 192, 255, 18, 14, 79, 175, 117, 201, 187, 128, 6, 136, 161, 110,
		132, 245, 130, 179, 62, 84, 240, 83, 96, 243, 231, 235, 1, 24, 1, 39,
		251, 216, 245, 197, 98, 142, 76, 255, 13,
	}

	rc4 := RC4{}
	rc4.Init(inputKey)
	next := rc4.KeyStream()
	for i := 0; i < 100; i++ {
		key := next()
		if outputStream[i] != key {
			t.Error("Key Stream Error!")
		}
	}
}
